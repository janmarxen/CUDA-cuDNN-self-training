{
  "cells": [
    {
      "cell_type": "code",
      "execution_count": 1,
      "id": "1f2dd506-9d7f-4df3-8787-d11ab585fbe5",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "1f2dd506-9d7f-4df3-8787-d11ab585fbe5",
        "outputId": "18e88304-3f64-4017-b911-73a4c47338fb"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "/bin/bash: line 1: module: command not found\n",
            "/bin/bash: line 1: module: command not found\n"
          ]
        }
      ],
      "source": [
        "!module load CUDA/12\n",
        "!module load cuDNN/9.5.0.50-CUDA-12"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "id": "a2d6fdf8",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "a2d6fdf8",
        "outputId": "d018c927-08d4-4374-e699-2d0d809f1179"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\u001b[01m\u001b[Kcc1plus:\u001b[m\u001b[K \u001b[01;31m\u001b[Kfatal error: \u001b[m\u001b[Kattention.cu: No such file or directory\n",
            "compilation terminated.\n"
          ]
        }
      ],
      "source": [
        "!nvcc -lcudnn -lcublas -o attention attention.cu"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "4db67f41-fd6b-4a90-a119-9ef1bd805b6e",
      "metadata": {
        "id": "4db67f41-fd6b-4a90-a119-9ef1bd805b6e",
        "outputId": "dae3af75-fa3e-478f-b7ff-08d408053934"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Submitted batch job 722736\n"
          ]
        }
      ],
      "source": [
        "!sbatch ./launch_job.sbatch"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "ad21561e-432d-4bb5-9739-dcaa1d7bb892",
      "metadata": {
        "id": "ad21561e-432d-4bb5-9739-dcaa1d7bb892",
        "outputId": "b32877d7-33ba-48fe-f181-cd262e33968f"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)\n",
            "            722736      gpus cuda_pro  marxen1 CF       4:00      1 jsfc020\n"
          ]
        }
      ],
      "source": [
        "!squeue -u $USER"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "32f1da7d"
      },
      "source": [
        "Here's the code to read and display the content of your notebook file. You can then copy this output and paste it into a new Colab notebook."
      ],
      "id": "32f1da7d"
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "2c0f3135",
        "outputId": "cd61c2bd-8961-4768-b440-5accd9242ebf"
      },
      "source": [
        "notebook_path = \"/content/CUDA-cuDNN-self-training/cuDNN Exercise/cuDNN_Exercise.ipynb\"\n",
        "\n",
        "try:\n",
        "    with open(notebook_path, 'r') as f:\n",
        "        notebook_content = f.read()\n",
        "    print(notebook_content)\n",
        "except FileNotFoundError:\n",
        "    print(f\"Error: The file was not found at {notebook_path}\")\n",
        "except Exception as e:\n",
        "    print(f\"An error occurred: {e}\")"
      ],
      "id": "2c0f3135",
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "{\n",
            " \"cells\": [\n",
            "  {\n",
            "   \"cell_type\": \"code\",\n",
            "   \"execution_count\": 11,\n",
            "   \"id\": \"1f2dd506-9d7f-4df3-8787-d11ab585fbe5\",\n",
            "   \"metadata\": {},\n",
            "   \"outputs\": [],\n",
            "   \"source\": [\n",
            "    \"!module load CUDA/12\\n\",\n",
            "    \"!module load cuDNN/9.5.0.50-CUDA-12\"\n",
            "   ]\n",
            "  },\n",
            "  {\n",
            "   \"cell_type\": \"code\",\n",
            "   \"execution_count\": 19,\n",
            "   \"id\": \"a2d6fdf8\",\n",
            "   \"metadata\": {},\n",
            "   \"outputs\": [],\n",
            "   \"source\": [\n",
            "    \"!nvcc -I/p/software/default/stages/2025/software/cuDNN/9.5.0.50-CUDA-12/include \\\\\\n\",\n",
            "    \"    -L/p/software/default/stages/2025/software/cuDNN/9.5.0.50-CUDA-12/lib \\\\\\n\",\n",
            "    \"    -lcudnn -lcublas -o attention attention.cu\"\n",
            "   ]\n",
            "  },\n",
            "  {\n",
            "   \"cell_type\": \"code\",\n",
            "   \"execution_count\": 20,\n",
            "   \"id\": \"4db67f41-fd6b-4a90-a119-9ef1bd805b6e\",\n",
            "   \"metadata\": {},\n",
            "   \"outputs\": [\n",
            "    {\n",
            "     \"name\": \"stdout\",\n",
            "     \"output_type\": \"stream\",\n",
            "     \"text\": [\n",
            "      \"Submitted batch job 722736\\n\"\n",
            "     ]\n",
            "    }\n",
            "   ],\n",
            "   \"source\": [\n",
            "    \"!sbatch ./launch_job.sbatch\"\n",
            "   ]\n",
            "  },\n",
            "  {\n",
            "   \"cell_type\": \"code\",\n",
            "   \"execution_count\": 23,\n",
            "   \"id\": \"ad21561e-432d-4bb5-9739-dcaa1d7bb892\",\n",
            "   \"metadata\": {},\n",
            "   \"outputs\": [\n",
            "    {\n",
            "     \"name\": \"stdout\",\n",
            "     \"output_type\": \"stream\",\n",
            "     \"text\": [\n",
            "      \"             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)\\n\",\n",
            "      \"            722736      gpus cuda_pro  marxen1 CF       4:00      1 jsfc020\\n\"\n",
            "     ]\n",
            "    }\n",
            "   ],\n",
            "   \"source\": [\n",
            "    \"!squeue -u $USER\"\n",
            "   ]\n",
            "  }\n",
            " ],\n",
            " \"metadata\": {\n",
            "  \"kernelspec\": {\n",
            "   \"display_name\": \"Python 3 (ipykernel)\",\n",
            "   \"language\": \"python\",\n",
            "   \"name\": \"python3\"\n",
            "  },\n",
            "  \"language_info\": {\n",
            "   \"codemirror_mode\": {\n",
            "    \"name\": \"ipython\",\n",
            "    \"version\": 3\n",
            "   },\n",
            "   \"file_extension\": \".py\",\n",
            "   \"mimetype\": \"text/x-python\",\n",
            "   \"name\": \"python\",\n",
            "   \"nbconvert_exporter\": \"python\",\n",
            "   \"pygments_lexer\": \"ipython3\",\n",
            "   \"version\": \"3.12.3\"\n",
            "  }\n",
            " },\n",
            " \"nbformat\": 4,\n",
            " \"nbformat_minor\": 5\n",
            "}\n",
            "\n"
          ]
        }
      ]
    }
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.12.3"
    },
    "colab": {
      "provenance": [],
      "gpuType": "T4"
    },
    "accelerator": "GPU"
  },
  "nbformat": 4,
  "nbformat_minor": 5
}